# Production Deployment Patterns

## Frontend (Netlify)
- **Build Command**: `npm run build`
- **Publish Directory**: `dist/`
- **Environment Variables**: 
  - `VITE_API_BASE`: Railway backend URL (e.g., `https://backend-production-80f6.up.railway.app`)
- **localStorage**: Disabled globally via [index.html](mdc:index.html) script injection
- **API Endpoints**: All requests go to Railway backend, never localhost

## Backend (Railway)
- **Start Command**: `npm run start` (runs migrations + starts server)
- **Database**: PostgreSQL with Prisma ORM
- **Environment Variables**:
  - `DATABASE_URL`: Railway PostgreSQL connection string
  - `PORT`: `8787`
- **Migrations**: Auto-run on startup via `prisma migrate deploy`

## Critical Deployment Steps
1. **Frontend**: Build `dist/` → drag-drop to Netlify
2. **Backend**: Deploy via Railway CLI or dashboard
3. **Verify**: Health check `https://backend-production-80f6.up.railway.app/health`
4. **Test**: Upload CSV → should POST to Railway, not localhost

## Common Issues
- **500 P2003**: Missing Organization record → Backend needs redeploy
- **localhost errors**: Frontend not using Railway URL → Check `VITE_API_BASE`
- **localStorage errors**: Browser storage disabled → Expected behavior
description:
globs:
alwaysApply: true
---
