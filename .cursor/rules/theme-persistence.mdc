---
description: Theme persistence and first-paint correctness
globs: *.tsx,*.html
---
# Theme Persistence Rules

- Storage key must be `appsamurai-dashboard-theme`.
- Apply theme before React hydration in [index.html](mdc:index.html) using a pre-hydration script that sets `document.documentElement` class to `dark` or `light`.
- Use `useLayoutEffect` in [src/contexts/ThemeContext.tsx](mdc:src/contexts/ThemeContext.tsx) to apply class changes without flicker.
- Listen to system theme changes only when `theme === 'system'`.
- Toggle component: [src/components/ThemeToggle.tsx](mdc:src/components/ThemeToggle.tsx).
---
description: Theme persistence and first-paint correctness
globs: src/contexts/ThemeContext.tsx,src/components/ThemeToggle.tsx,src/main.tsx
---
# Theme Persistence Rules

- Storage key must be `appsamurai-dashboard-theme`.
- Read and write theme with error handling.
- Apply theme using `useLayoutEffect` to avoid flash of system theme on refresh.
- Listen to system theme changes only when `theme === 'system'`.

References: [src/contexts/ThemeContext.tsx](mdc:src/contexts/ThemeContext.tsx), [src/main.tsx](mdc:src/main.tsx)

